<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<title>Windows Classic Simulator</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<style>
  html, body { height: 100%; }
  body {
    margin: 0; background: #008080; font-family: "MS Sans Serif", Tahoma, Geneva, sans-serif;
    overflow: hidden;
  }
  #bootScreen {
    position: fixed; inset: 0; background: #000080; color: #fff;
    display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 16px;
    font-size: 22px;
  }
  .loadingBar { width: 220px; height: 18px; border: 2px solid #fff; }
  .progress { width: 0; height: 100%; background: #00ff00; animation: load 3.8s linear forwards; }
  @keyframes load { to { width: 100%; } }
  #loginScreen {
    position: fixed; inset: 0; background: #c0c0c0; display: none;
    align-items: center; justify-content: center; flex-direction: column; gap: 8px;
    font-size: 14px;
  }
  #loginBox {
    background: #c0c0c0; border: 2px solid #000;
    box-shadow: inset 2px 2px #fff, inset -2px -2px #808080; padding: 12px 14px; min-width: 280px;
  }
  #desktop { position: absolute; inset: 0 0 32px 0; display: none; }
  .icon {
    width: 82px; text-align: center; color: #fff; font-size: 12px;
    position: absolute; cursor: default; user-select: none;
  }
  .icon img { width: 32px; height: 32px; image-rendering: pixelated; }
  .icon .label { margin-top: 4px; text-shadow: 1px 1px #000; }
  .taskbar {
    position: fixed; bottom: 0; left: 0; right: 0; height: 32px;
    background: #c0c0c0; border-top: 2px solid #fff;
    box-shadow: inset 0 2px #808080, inset 0 -2px #fff;
    display: flex; align-items: center; padding: 2px 4px; gap: 6px;
  }
  .start-btn {
    background: #c0c0c0; border: 2px solid #000;
    box-shadow: inset 2px 2px #fff, inset -2px -2px #808080;
    padding: 2px 8px; cursor: pointer; font-weight: bold;
  }
  .tasks { flex: 1; display: flex; gap: 6px; overflow: hidden; }
  .task-item {
    background: #e0e0e0; border: 2px solid #000;
    box-shadow: inset 2px 2px #fff, inset -2px -2px #808080;
    padding: 2px 8px; cursor: pointer; white-space: nowrap; text-overflow: ellipsis; overflow: hidden;
  }
  .clock {
    margin-left: auto; padding: 2px 8px;
    background: #e0e0e0; border: 2px solid #000;
    box-shadow: inset 2px 2px #fff, inset -2px -2px #808080;
    font-size: 12px;
  }
  .window {
    position: absolute; width: 420px; background: #c0c0c0; border: 2px solid #000;
    box-shadow: inset 2px 2px #fff, inset -2px -2px #808080;
  }
  .titlebar {
    background: #000080; color: #fff; padding: 3px 6px; display: flex; justify-content: space-between; align-items: center;
    cursor: move; font-weight: bold; user-select: none;
  }
  .controls { display: flex; gap: 4px; }
  .btn {
    width: 18px; height: 18px; background: #c0c0c0; border: 1px solid #000;
    box-shadow: inset 1px 1px #fff, inset -1px -1px #808080; text-align: center; line-height: 18px; cursor: pointer;
  }
  .content {
    padding: 10px; background: #e0e0e0; border-top: 2px solid #fff; min-height: 160px;
    color: #000; font-size: 13px; white-space: pre-wrap;
  }
</style>
</head>
<body>
<div id="bootScreen">
  <div>Windows 95</div>
  <div class="loadingBar"><div class="progress"></div></div>
</div>

<div id="loginScreen">
  <div id="loginBox">
    <p style="margin:0 0 6px 0; font-weight:bold;">로그인</p>
    <p>이름을 입력하세요:</p>
    <input type="text" id="loginName" />
    <p>비밀번호를 입력하세요:</p>
    <input type="password" id="loginPass" />
    <div style="margin-top:8px; display:flex; gap:8px;">
      <button id="loginBtn">로그인</button>
      <button id="guestBtn">게스트</button>
    </div>
    <p id="loginMsg"></p>
  </div>
</div>

<div id="desktop">
  <div class="icon" style="top:20px;left:20px" data-open="doc:world">
    <img src="https://cdn-icons-png.flaticon.com/512/337/337946.png"><div class="label">입사 지원서</div>
  </div>
  <div class="icon" style="top:110px;left:20px" data-open="doc:horror" id="horrorIcon">
    <img src="https://cdn-icons-png.flaticon.com/512/337/337946.png"><div class="label">보안 문서</div>
  </div>
  <div class="icon" style="top:110px;left:20px;display:none" data-open="doc:recruit" id="recruitIcon">
    <img src="https://cdn-icons-png.flaticon.com/512/337/337946.png"><div class="label">신입사원 모집 공지</div>
  </div>
  <div class="icon" style="top:200px;left:20px" data-open="npc" id="npc">
    <img src="https://cdn-icons-png.flaticon.com/512/149/149071.png"><div class="label">NPC 소개</div>
  </div>
</div>

<div class="taskbar">
  <div class="start-btn" id="startBtn">Start</div>
  <div class="tasks" id="tasks"></div>
  <div class="clock" id="clock"></div>
</div>

<template id="windowTemplate">
  <div class="window" style="top:70px;left:120px">
    <div class="titlebar">
      <span class="title">Window</span>
      <div class="controls">
        <div class="btn btn-min">_</div>
        <div class="btn btn-close">X</div>
      </div>
    </div>
    <div class="content"></div>
  </div>
</template>

<script>
let zTop = 10;
let isGuest = false;
const tasks = document.getElementById('tasks');
const tpl = document.getElementById('windowTemplate');

setTimeout(() => {
  document.getElementById('bootScreen').style.display = 'none';
  document.getElementById('loginScreen').style.display = 'flex';
}, 3800);

document.getElementById('loginBtn').addEventListener('click', () => {
  const name = document.getElementById('loginName').value || "사용자";
  const pass = document.getElementById('loginPass').value;
  if (pass === "secret123") {
    enterDesktop(name, false);
  } else {
    document.getElementById('loginMsg').textContent = "비밀번호가 틀렸습니다.";
  }
});

document.getElementById('guestBtn').addEventListener('click', () => {
  enterDesktop("사용자", true);
});

function enterDesktop(userName, guest=false) {
  isGuest = guest;
  document.getElementById('loginScreen').style.display = 'none';
  document.getElementById('desktop').style.display = 'block';
  const msg = guest ? "사용자님 환영합니다" : `${userName}님 환영합니다`;
  createWindow("환영합니다", msg + "<br>시스템에 접속하셨습니다만...");

  if (guest) {
    document.getElementById('horrorIcon').style.display = "none";
    document.getElementById('recruitIcon').style.display = "block";
    document.getElementById('npc').style.display = "none";
  } else {
    document.getElementById('horrorIcon').style.display = "block";
    document.getElementById('recruitIcon').style.display = "none";
    document.getElementById('npc').style.display = "block";
  }
}

function dispatchOpen(token) {
  if (token === 'doc:world') {
    createWindow("입사 지원서", "세계관 문서 내용...");
  } else if (token === 'npc') {
    if(isGuest){
      createWindow("권한 없음", "게스트 계정은 NPC 문서를 열람할 수 없습니다.");
    } else {
      createWindow("NPC 소개", "<ul><li>분석팀장...</li><li>필드요원...</li></ul>");
    }
  } else if (token === 'doc:horror') {
    if(isGuest){
      createWindow("권한 없음", "게스트 계정은 공포 문서를 열람할 수 없습니다.");
    } else {
      createWindow("보안 문서", "⚠️ 트라우마를 유발할 수 있습니다. 그래도 열람하시겠습니까?");
    }
  } else if (token === 'doc:recruit') {
    createWindow("신입사원 모집 공지", "신입사원 모집 공지 내용...\n지원 자격: ...\n마감일: ...");
  }
}

function createWindow(title, htmlContent) {
  const node = tpl.content.firstElementChild.cloneNode(true);
  node.style.zIndex = ++zTop;
  node.querySelector('.title').textContent = title;
  const content = node.querySelector('.content');
  if (typeof htmlContent === 'string') {
    content.innerHTML = htmlContent;
  }
  const task = document.createElement('div');
  task.className = 'task-item';
  task.textContent = title;
  task.addEventListener('click', () => {
    node.classList.remove('hidden');
    focusWindow(node);
  });
  tasks.appendChild(task);
  node.querySelector('.btn-close').addEventListener('click', () => {
    node.remove();
    task.remove();
  });
  node.querySelector('.btn-min').addEventListener('click', () => {
    node.classList.add('hidden');
  });
  makeDraggable(node);
  document.body.appendChild(node);
  focusWindow(node);
  return node;
}

function focusWindow(node) {
  node.style.zIndex = ++zTop;
}

function makeDraggable(win) {
  const bar = win.querySelector('.titlebar');
  let offsetX, offsetY, dragging = false;
  bar.addEventListener('mousedown', e => {
    dragging = true;
    offsetX = e.clientX - win.offsetLeft;
    offsetY = e.clientY - win.offsetTop;
    focusWindow(win);
  });
  document.addEventListener('mousemove', e => {
    if (dragging) {
      win.style.left = (e.clientX - offsetX) + 'px';
      win.style.top = (e.clientY - offsetY) + 'px';
    }
  });
  document.addEventListener('mouseup', () => dragging = false);
}

function updateClock() {
  const now = new Date();
  document.getElementById('clock').textContent =
    now.getHours().toString().padStart(2,'0') + ":" +
    now.getMinutes().toString().padStart(2,'0');
}
setInterval(updateClock, 1000);
updateClock();

document.querySelectorAll('.icon').forEach(icon => {
  icon.addEventListener('dblclick', () => {
    dispatchOpen(icon.dataset.open);
  });
});
</script>
</body>
</html>
